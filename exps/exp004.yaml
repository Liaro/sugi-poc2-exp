# 差分で学習
env:
  dataset_id: exp004
preprocess:
  sql:
    # 予測時に用いるSQLかどうか
    is_prediction: False
    # 何日分処方量を足した値をtargetにするか
    sum_days: 28
    train_days: 545
    valid_days: 14
    test_days: 56
    # 過去の統計量をとるのに使用するBQ集計関数
    ops: ["AVG", "STDDEV", "MIN", "MAX"]
    # 過去の統計量をとるのに使用するBQ集計関数
    category_ops: ["AVG", "STDDEV"]
    # 何日前までで上の統計量を計算するか
    preceding_days: [365, 180, 90, 60, 30]
    # 何日前のLag特徴量を作成するか
    # 実際には月予測をしているので、sum_days + lag_day日前のlagを取っている
    lag_days: [1, 2, 3, 4, 5, 6, 7, 14, 21, 28]
    # 前回の処方日からの経過日数をClipする最大値
    max_last_prescription_days: 200
    update_days: ${update_days}
feature:
  label_col: diff_total_dose_monthly
  numerical_cols: [
      "day",
      "day_cos",
      "day_from_last_prescription",
      "day_sin",
      "dayofweek",
      "dayofweek_cos",
      "dayofweek_sin",
      "dayofyear",
      "dayofyear_cos",
      "dayofyear_sin",
      "days_from_application",
      "lag14_minus_avg180_by_yj",
      "lag14_minus_avg180_by_yj_store",
      "lag14_minus_avg30_by_yj",
      "lag14_minus_avg30_by_yj_store",
      "lag14_minus_avg365_by_yj",
      "lag14_minus_avg365_by_yj_store",
      "lag14_minus_avg60_by_yj",
      "lag14_minus_avg60_by_yj_store",
      "lag14_minus_avg90_by_yj",
      "lag14_minus_avg90_by_yj_store",
      "lag14_nunique_patient_by_yj",
      "lag14_nunique_patient_by_yj_store",
      "lag14_total_dose_by_yj",
      "lag14_total_dose_by_yj_store",
      "lag14_total_price_by_yj",
      "lag14_total_price_by_yj_store",
      "lag1_minus_avg180_by_yj",
      "lag1_minus_avg180_by_yj_store",
      "lag1_minus_avg30_by_yj",
      "lag1_minus_avg30_by_yj_store",
      "lag1_minus_avg365_by_yj",
      "lag1_minus_avg365_by_yj_store",
      "lag1_minus_avg60_by_yj",
      "lag1_minus_avg60_by_yj_store",
      "lag1_minus_avg90_by_yj",
      "lag1_minus_avg90_by_yj_store",
      "lag1_nunique_patient_by_yj",
      "lag1_nunique_patient_by_yj_store",
      "lag1_total_dose_by_yj",
      "lag1_total_dose_by_yj_store",
      "lag1_total_price_by_yj",
      "lag1_total_price_by_yj_store",
      "lag21_minus_avg180_by_yj",
      "lag21_minus_avg180_by_yj_store",
      "lag21_minus_avg30_by_yj",
      "lag21_minus_avg30_by_yj_store",
      "lag21_minus_avg365_by_yj",
      "lag21_minus_avg365_by_yj_store",
      "lag21_minus_avg60_by_yj",
      "lag21_minus_avg60_by_yj_store",
      "lag21_minus_avg90_by_yj",
      "lag21_minus_avg90_by_yj_store",
      "lag21_nunique_patient_by_yj",
      "lag21_nunique_patient_by_yj_store",
      "lag21_total_dose_by_yj",
      "lag21_total_dose_by_yj_store",
      "lag21_total_price_by_yj",
      "lag21_total_price_by_yj_store",
      "lag28_minus_avg180_by_yj",
      "lag28_minus_avg180_by_yj_store",
      "lag28_minus_avg30_by_yj",
      "lag28_minus_avg30_by_yj_store",
      "lag28_minus_avg365_by_yj",
      "lag28_minus_avg365_by_yj_store",
      "lag28_minus_avg60_by_yj",
      "lag28_minus_avg60_by_yj_store",
      "lag28_minus_avg90_by_yj",
      "lag28_minus_avg90_by_yj_store",
      "lag28_nunique_patient_by_yj",
      "lag28_nunique_patient_by_yj_store",
      "lag28_total_dose_by_yj",
      "lag28_total_dose_by_yj_store",
      "lag28_total_price_by_yj",
      "lag28_total_price_by_yj_store",
      "lag2_minus_avg180_by_yj",
      "lag2_minus_avg180_by_yj_store",
      "lag2_minus_avg30_by_yj",
      "lag2_minus_avg30_by_yj_store",
      "lag2_minus_avg365_by_yj",
      "lag2_minus_avg365_by_yj_store",
      "lag2_minus_avg60_by_yj",
      "lag2_minus_avg60_by_yj_store",
      "lag2_minus_avg90_by_yj",
      "lag2_minus_avg90_by_yj_store",
      "lag2_nunique_patient_by_yj",
      "lag2_nunique_patient_by_yj_store",
      "lag2_total_dose_by_yj",
      "lag2_total_dose_by_yj_store",
      "lag2_total_price_by_yj",
      "lag2_total_price_by_yj_store",
      "lag3_minus_avg180_by_yj",
      "lag3_minus_avg180_by_yj_store",
      "lag3_minus_avg30_by_yj",
      "lag3_minus_avg30_by_yj_store",
      "lag3_minus_avg365_by_yj",
      "lag3_minus_avg365_by_yj_store",
      "lag3_minus_avg60_by_yj",
      "lag3_minus_avg60_by_yj_store",
      "lag3_minus_avg90_by_yj",
      "lag3_minus_avg90_by_yj_store",
      "lag3_nunique_patient_by_yj",
      "lag3_nunique_patient_by_yj_store",
      "lag3_total_dose_by_yj",
      "lag3_total_dose_by_yj_store",
      "lag3_total_price_by_yj",
      "lag3_total_price_by_yj_store",
      "lag4_minus_avg180_by_yj",
      "lag4_minus_avg180_by_yj_store",
      "lag4_minus_avg30_by_yj",
      "lag4_minus_avg30_by_yj_store",
      "lag4_minus_avg365_by_yj",
      "lag4_minus_avg365_by_yj_store",
      "lag4_minus_avg60_by_yj",
      "lag4_minus_avg60_by_yj_store",
      "lag4_minus_avg90_by_yj",
      "lag4_minus_avg90_by_yj_store",
      "lag4_nunique_patient_by_yj",
      "lag4_nunique_patient_by_yj_store",
      "lag4_total_dose_by_yj",
      "lag4_total_dose_by_yj_store",
      "lag4_total_price_by_yj",
      "lag4_total_price_by_yj_store",
      "lag5_minus_avg180_by_yj",
      "lag5_minus_avg180_by_yj_store",
      "lag5_minus_avg30_by_yj",
      "lag5_minus_avg30_by_yj_store",
      "lag5_minus_avg365_by_yj",
      "lag5_minus_avg365_by_yj_store",
      "lag5_minus_avg60_by_yj",
      "lag5_minus_avg60_by_yj_store",
      "lag5_minus_avg90_by_yj",
      "lag5_minus_avg90_by_yj_store",
      "lag5_nunique_patient_by_yj",
      "lag5_nunique_patient_by_yj_store",
      "lag5_total_dose_by_yj",
      "lag5_total_dose_by_yj_store",
      "lag5_total_price_by_yj",
      "lag5_total_price_by_yj_store",
      "lag6_minus_avg180_by_yj",
      "lag6_minus_avg180_by_yj_store",
      "lag6_minus_avg30_by_yj",
      "lag6_minus_avg30_by_yj_store",
      "lag6_minus_avg365_by_yj",
      "lag6_minus_avg365_by_yj_store",
      "lag6_minus_avg60_by_yj",
      "lag6_minus_avg60_by_yj_store",
      "lag6_minus_avg90_by_yj",
      "lag6_minus_avg90_by_yj_store",
      "lag6_nunique_patient_by_yj",
      "lag6_nunique_patient_by_yj_store",
      "lag6_total_dose_by_yj",
      "lag6_total_dose_by_yj_store",
      "lag6_total_price_by_yj",
      "lag6_total_price_by_yj_store",
      "lag7_minus_avg180_by_yj",
      "lag7_minus_avg180_by_yj_store",
      "lag7_minus_avg30_by_yj",
      "lag7_minus_avg30_by_yj_store",
      "lag7_minus_avg365_by_yj",
      "lag7_minus_avg365_by_yj_store",
      "lag7_minus_avg60_by_yj",
      "lag7_minus_avg60_by_yj_store",
      "lag7_minus_avg90_by_yj",
      "lag7_minus_avg90_by_yj_store",
      "lag7_nunique_patient_by_yj",
      "lag7_nunique_patient_by_yj_store",
      "lag7_total_dose_by_yj",
      "lag7_total_dose_by_yj_store",
      "lag7_total_price_by_yj",
      "lag7_total_price_by_yj_store",
      "lag_non_zero_minus_avg180_by_yj_store",
      "lag_non_zero_minus_avg30_by_yj_store",
      "lag_non_zero_minus_avg365_by_yj_store",
      "lag_non_zero_minus_avg60_by_yj_store",
      "lag_non_zero_minus_avg90_by_yj_store",
      "lag_non_zero_total_dose_by_yj",
      "lag_non_zero_total_dose_by_yj_store",
      "nunique_patient_by_yj_AVG_180",
      "nunique_patient_by_yj_AVG_30",
      "nunique_patient_by_yj_AVG_365",
      "nunique_patient_by_yj_AVG_60",
      "nunique_patient_by_yj_AVG_90",
      "nunique_patient_by_yj_MAX_180",
      "nunique_patient_by_yj_MAX_30",
      "nunique_patient_by_yj_MAX_365",
      "nunique_patient_by_yj_MAX_60",
      "nunique_patient_by_yj_MAX_90",
      "nunique_patient_by_yj_MIN_180",
      "nunique_patient_by_yj_MIN_30",
      "nunique_patient_by_yj_MIN_365",
      "nunique_patient_by_yj_MIN_60",
      "nunique_patient_by_yj_MIN_90",
      "nunique_patient_by_yj_STDDEV_180",
      "nunique_patient_by_yj_STDDEV_30",
      "nunique_patient_by_yj_STDDEV_365",
      "nunique_patient_by_yj_STDDEV_60",
      "nunique_patient_by_yj_STDDEV_90",
      "nunique_patient_by_yj_store_AVG_180",
      "nunique_patient_by_yj_store_AVG_30",
      "nunique_patient_by_yj_store_AVG_365",
      "nunique_patient_by_yj_store_AVG_60",
      "nunique_patient_by_yj_store_AVG_90",
      "nunique_patient_by_yj_store_MAX_180",
      "nunique_patient_by_yj_store_MAX_30",
      "nunique_patient_by_yj_store_MAX_365",
      "nunique_patient_by_yj_store_MAX_60",
      "nunique_patient_by_yj_store_MAX_90",
      "nunique_patient_by_yj_store_MIN_180",
      "nunique_patient_by_yj_store_MIN_30",
      "nunique_patient_by_yj_store_MIN_365",
      "nunique_patient_by_yj_store_MIN_60",
      "nunique_patient_by_yj_store_MIN_90",
      "nunique_patient_by_yj_store_STDDEV_180",
      "nunique_patient_by_yj_store_STDDEV_30",
      "nunique_patient_by_yj_store_STDDEV_365",
      "nunique_patient_by_yj_store_STDDEV_60",
      "nunique_patient_by_yj_store_STDDEV_90",
      "total_dose_by_name_store_AVG_180",
      "total_dose_by_name_store_AVG_30",
      "total_dose_by_name_store_AVG_365",
      "total_dose_by_name_store_AVG_60",
      "total_dose_by_name_store_AVG_90",
      "total_dose_by_name_store_STDDEV_180",
      "total_dose_by_name_store_STDDEV_30",
      "total_dose_by_name_store_STDDEV_365",
      "total_dose_by_name_store_STDDEV_60",
      "total_dose_by_name_store_STDDEV_90",
      "total_dose_by_name_store_dts_AVG_180",
      "total_dose_by_name_store_dts_AVG_30",
      "total_dose_by_name_store_dts_AVG_365",
      "total_dose_by_name_store_dts_AVG_60",
      "total_dose_by_name_store_dts_AVG_90",
      "total_dose_by_name_store_dts_STDDEV_180",
      "total_dose_by_name_store_dts_STDDEV_30",
      "total_dose_by_name_store_dts_STDDEV_365",
      "total_dose_by_name_store_dts_STDDEV_60",
      "total_dose_by_name_store_dts_STDDEV_90",
      "total_dose_by_yj_AVG_180",
      "total_dose_by_yj_AVG_30",
      "total_dose_by_yj_AVG_365",
      "total_dose_by_yj_AVG_60",
      "total_dose_by_yj_AVG_90",
      "total_dose_by_yj_MAX_180",
      "total_dose_by_yj_MAX_30",
      "total_dose_by_yj_MAX_365",
      "total_dose_by_yj_MAX_60",
      "total_dose_by_yj_MAX_90",
      "total_dose_by_yj_MIN_180",
      "total_dose_by_yj_MIN_30",
      "total_dose_by_yj_MIN_365",
      "total_dose_by_yj_MIN_60",
      "total_dose_by_yj_MIN_90",
      "total_dose_by_yj_STDDEV_180",
      "total_dose_by_yj_STDDEV_30",
      "total_dose_by_yj_STDDEV_365",
      "total_dose_by_yj_STDDEV_60",
      "total_dose_by_yj_STDDEV_90",
      "total_dose_by_yj_dow_AVG_180",
      "total_dose_by_yj_dow_AVG_30",
      "total_dose_by_yj_dow_AVG_365",
      "total_dose_by_yj_dow_AVG_60",
      "total_dose_by_yj_dow_AVG_90",
      "total_dose_by_yj_dow_STDDEV_180",
      "total_dose_by_yj_dow_STDDEV_30",
      "total_dose_by_yj_dow_STDDEV_365",
      "total_dose_by_yj_dow_STDDEV_60",
      "total_dose_by_yj_dow_STDDEV_90",
      "total_dose_by_yj_dts_AVG_180",
      "total_dose_by_yj_dts_AVG_30",
      "total_dose_by_yj_dts_AVG_365",
      "total_dose_by_yj_dts_AVG_60",
      "total_dose_by_yj_dts_AVG_90",
      "total_dose_by_yj_dts_STDDEV_180",
      "total_dose_by_yj_dts_STDDEV_30",
      "total_dose_by_yj_dts_STDDEV_365",
      "total_dose_by_yj_dts_STDDEV_60",
      "total_dose_by_yj_dts_STDDEV_90",
      "total_dose_by_yj_store_AVG_180",
      "total_dose_by_yj_store_AVG_30",
      "total_dose_by_yj_store_AVG_365",
      "total_dose_by_yj_store_AVG_60",
      "total_dose_by_yj_store_AVG_90",
      "total_dose_by_yj_store_MAX_180",
      "total_dose_by_yj_store_MAX_30",
      "total_dose_by_yj_store_MAX_365",
      "total_dose_by_yj_store_MAX_60",
      "total_dose_by_yj_store_MAX_90",
      "total_dose_by_yj_store_MIN_180",
      "total_dose_by_yj_store_MIN_30",
      "total_dose_by_yj_store_MIN_365",
      "total_dose_by_yj_store_MIN_60",
      "total_dose_by_yj_store_MIN_90",
      "total_dose_by_yj_store_STDDEV_180",
      "total_dose_by_yj_store_STDDEV_30",
      "total_dose_by_yj_store_STDDEV_365",
      "total_dose_by_yj_store_STDDEV_60",
      "total_dose_by_yj_store_STDDEV_90",
      "total_dose_by_yj_store_dow_AVG_180",
      "total_dose_by_yj_store_dow_AVG_30",
      "total_dose_by_yj_store_dow_AVG_365",
      "total_dose_by_yj_store_dow_AVG_60",
      "total_dose_by_yj_store_dow_AVG_90",
      "total_dose_by_yj_store_dow_STDDEV_180",
      "total_dose_by_yj_store_dow_STDDEV_30",
      "total_dose_by_yj_store_dow_STDDEV_365",
      "total_dose_by_yj_store_dow_STDDEV_60",
      "total_dose_by_yj_store_dow_STDDEV_90",
      "total_dose_by_yj_store_dts_AVG_180",
      "total_dose_by_yj_store_dts_AVG_30",
      "total_dose_by_yj_store_dts_AVG_365",
      "total_dose_by_yj_store_dts_AVG_60",
      "total_dose_by_yj_store_dts_AVG_90",
      "total_dose_by_yj_store_dts_STDDEV_180",
      "total_dose_by_yj_store_dts_STDDEV_30",
      "total_dose_by_yj_store_dts_STDDEV_365",
      "total_dose_by_yj_store_dts_STDDEV_60",
      "total_dose_by_yj_store_dts_STDDEV_90",
      "total_price_by_yj_AVG_180",
      "total_price_by_yj_AVG_30",
      "total_price_by_yj_AVG_365",
      "total_price_by_yj_AVG_60",
      "total_price_by_yj_AVG_90",
      "total_price_by_yj_MAX_180",
      "total_price_by_yj_MAX_30",
      "total_price_by_yj_MAX_365",
      "total_price_by_yj_MAX_60",
      "total_price_by_yj_MAX_90",
      "total_price_by_yj_MIN_180",
      "total_price_by_yj_MIN_30",
      "total_price_by_yj_MIN_365",
      "total_price_by_yj_MIN_60",
      "total_price_by_yj_MIN_90",
      "total_price_by_yj_STDDEV_180",
      "total_price_by_yj_STDDEV_30",
      "total_price_by_yj_STDDEV_365",
      "total_price_by_yj_STDDEV_60",
      "total_price_by_yj_STDDEV_90",
      "total_price_by_yj_store_AVG_180",
      "total_price_by_yj_store_AVG_30",
      "total_price_by_yj_store_AVG_365",
      "total_price_by_yj_store_AVG_60",
      "total_price_by_yj_store_AVG_90",
      "total_price_by_yj_store_MAX_180",
      "total_price_by_yj_store_MAX_30",
      "total_price_by_yj_store_MAX_365",
      "total_price_by_yj_store_MAX_60",
      "total_price_by_yj_store_MAX_90",
      "total_price_by_yj_store_MIN_180",
      "total_price_by_yj_store_MIN_30",
      "total_price_by_yj_store_MIN_365",
      "total_price_by_yj_store_MIN_60",
      "total_price_by_yj_store_MIN_90",
      "total_price_by_yj_store_STDDEV_180",
      "total_price_by_yj_store_STDDEV_30",
      "total_price_by_yj_store_STDDEV_365",
      "total_price_by_yj_store_STDDEV_60",
      "total_price_by_yj_store_STDDEV_90",
      "week",
      # "AVG_day_from_last_dispensing_yj_store",
      # "AVG_diff_pred_prescription_date_yj_store",
      # "AVG_diff_stats_prescription_date_yj_store",
      # "AVG_num_visit_yj_store",
      # "MAX_day_from_last_dispensing_yj_store",
      # "MAX_diff_pred_prescription_date_yj_store",
      # "MAX_diff_stats_prescription_date_yj_store",
      # "MAX_num_visit_yj_store",
      # "MIN_day_from_last_dispensing_yj_store",
      # "MIN_diff_pred_prescription_date_yj_store",
      # "MIN_diff_stats_prescription_date_yj_store",
      # "MIN_num_visit_yj_store",
      # "STDDEV_day_from_last_dispensing_yj_store",
      # "STDDEV_diff_pred_prescription_date_yj_store",
      # "STDDEV_diff_stats_prescription_date_yj_store",
      # "STDDEV_num_visit_yj_store",
      # "pred_presciption_AVG_lag_total_dose",
      # "pred_presciption_MAX_lag_total_dose",
      # "pred_presciption_MIN_lag_total_dose",
      # "pred_presciption_STDDEV_lag_total_dose",
      # "pred_presciption_sum_lag_total_dose",
      # "stats_presciption_AVG_lag_total_dose",
      # "stats_presciption_MAX_lag_total_dose",
      # "stats_presciption_MIN_lag_total_dose",
      # "stats_presciption_STDDEV_lag_total_dose",
      # "stats_presciption_sum_lag_total_dose",
    ]
